import{E as Y}from"./engine-23af3b94.js";let w=()=>{};function C(s,t){let i=s.indexOf(t);if(i!=-1)return s.splice(i,1),!0}let X={};function b(s,...t){(X[s]||[]).map(i=>i(...t))}let l,x,M={get(s,t){return t=="_proxy"?!0:w}};function E(){return x}function k(s,{contextless:t=!1}={}){if(l=document.getElementById(s)||s||document.querySelector("canvas"),t&&(l=l||new Proxy({},M)),!l)throw Error("You must provide a canvas element for the game");return x=l.getContext("2d")||new Proxy({},M),x.imageSmoothingEnabled=!1,b("init"),{canvas:l,context:x}}function F(s,t){let i=Math.sin(t),e=Math.cos(t);return{x:s.x*e-s.y*i,y:s.x*i+s.y*e}}function v(s,t,i){return Math.min(Math.max(s,i),t)}class d{constructor(t=0,i=0,e={}){this.x=t,this.y=i,e._c&&(this.clamp(e._a,e._b,e._d,e._e),this.x=t,this.y=i)}add(t){return new d(this.x+t.x,this.y+t.y,this)}subtract(t){return new d(this.x-t.x,this.y-t.y,this)}scale(t){return new d(this.x*t,this.y*t)}normalize(t=this.length()){return new d(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}clamp(t,i,e,h){this._c=!0,this._a=t,this._b=i,this._d=e,this._e=h}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?v(this._a,this._d,t):t}set y(t){this._y=this._c?v(this._b,this._e,t):t}}function A(){return new d(...arguments)}class z{constructor(t){return this.init(t)}init(t={}){this.position=A(),this.velocity=A(),this.acceleration=A(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.acceleration;t&&(i=i.scale(t)),this.velocity=this.velocity.add(i);let e=this.velocity;t&&(e=e.scale(t)),this.position=this.position.add(e),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}class L extends z{init({width:t=0,height:i=0,context:e=E(),render:h=this.draw,update:n=this.advance,children:r=[],anchor:a={x:0,y:0},opacity:c=1,rotation:u=0,scaleX:o=1,scaleY:_=1,...y}={}){this._c=[],super.init({width:t,height:i,context:e,anchor:a,opacity:c,rotation:u,scaleX:o,scaleY:_,...y}),this._di=!0,this._uw(),this.addChild(r),this._rf=h,this._uf=n}update(t){this._uf(t),this.children.map(i=>i.update&&i.update(t))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),(this.scaleX!=1||this.scaleY!=1)&&t.scale(this.scaleX,this.scaleY);let i=-this.width*this.anchor.x,e=-this.height*this.anchor.y;(i||e)&&t.translate(i,e),this.context.globalAlpha=this.opacity,this._rf(),(i||e)&&t.translate(-i,-e),this.children.map(n=>n.render&&n.render()),t.restore()}draw(){}_pc(){this._uw(),this.children.map(t=>t._pc())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:e=1,_wr:h=0,_wsx:n=1,_wsy:r=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=e*this.opacity,this._wsx=n*this.scaleX,this._wsy=r*this.scaleY,this._wx=this._wx*n,this._wy=this._wy*r,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=h+this.rotation;let{x:a,y:c}=F({x:this._wx,y:this._wy},h);this._wx=a,this._wy=c,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map(i=>{this.children.push(i),i.parent=this,i._pc=i._pc||w,i._pc()})}removeChild(...t){t.flat().map(i=>{C(this.children,i)&&(i.parent=null,i._pc())})}get opacity(){return this._opa}set opacity(t){this._opa=t,this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,i=t){this.scaleX=t,this.scaleY=i}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}class I extends L{init({image:t,width:i=t?t.width:void 0,height:e=t?t.height:void 0,...h}={}){super.init({image:t,width:i,height:e,...h})}get animations(){return this._a}set animations(t){let i,e;this._a={};for(i in t)this._a[i]=t[i].clone(),e=e||this._a[i];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function P(){return new I(...arguments)}function $(s){let t=s.canvas;s.clearRect(0,0,t.width,t.height)}function q({fps:s=60,clearCanvas:t=!0,update:i=w,render:e,context:h=E(),blur:n=!1}={}){if(!e)throw Error("You must provide a render() function");let r=0,a=1e3/s,c=1/s,u=t?$:w,o,_,y,f,p,m=!0;n||(window.addEventListener("focus",()=>{m=!0}),window.addEventListener("blur",()=>{m=!1}));function g(){if(_=requestAnimationFrame(g),!!m&&(y=performance.now(),f=y-o,o=y,!(f>1e3))){for(b("tick"),r+=f;r>=a;)p.update(c),r-=a;u(h),p.render()}}return p={update:i,render:e,isStopped:!0,start(){o=performance.now(),this.isStopped=!1,requestAnimationFrame(g)},stop(){this.isStopped=!0,cancelAnimationFrame(_)},_frame:g,set _last(S){o=S}},p}class O extends Y{constructor(){super()}init(){if(super.init(),this.canvas.innerHTML="",window.cancelAnimationFrame(this.request),!this.loop){const{context:h}=k();this.ctx=h,this.ctx.strokeStyle="white",this.ctx.lineWidth=1}this.type==="fill"&&(this.ctx.strokeStyle="black",this.ctx.fillStyle="white");const t=new Image;t.src="sprite.png";const i=new Array(this.count),e=[1,-1];for(let h=0;h<this.count;h++){const n=10+Math.random()*80,r=Math.random()*this.width,a=Math.random()*(this.height-n),[c,u]=[3*Math.random()*e[Math.floor(Math.random()*2)],3*Math.random()*e[Math.floor(Math.random()*2)]];let o;this.type==="sprite"&&(o=P({x:r,y:a,anchor:{x:.5,y:.5},image:t})),i[h]={x:r,y:a,size:n,dx:c,dy:u,el:o}}this.particles=i}render(){this.loop||(this.loop=q({update:()=>{for(let t=0;t<this.count;t++){const i=this.particles[t];i.x-=i.dx,i.y-=i.dy,i.x+i.size<0?i.dx*=-1:i.y+i.size<0&&(i.dy*=-1),i.x>this.width?i.dx*=-1:i.y>this.height&&(i.dy*=-1),i.el&&(i.el.x=i.x,i.el.y=i.y)}this.fpsmeter.tick()},render:()=>{for(let t=0;t<this.count;t++){const i=this.particles[t];this.type==="sprite"?i.el.render():(this.ctx.beginPath(),this.ctx.arc(i.x,i.y,i.size,0,2*Math.PI),this.type==="fill"&&this.ctx.fill(),this.ctx.stroke())}}}),this.loop.start())}}document.addEventListener("DOMContentLoaded",()=>{new O().render()});
